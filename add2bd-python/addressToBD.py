# -*- coding: UTF-8 -*-import sys, urllib2, json, time,typesfrom urllib import urlencode# 以下为配置区inputFilePath = 'D:/Test/python/121.csv'outFilePath = 'D:/Test/python/1211.csv'idIndex = 0    # 序号所在的列addressIndex = 1   # 地址数据所在的列cityIndex = '上海'   # 城市名所在的列(必须是城市名比如上海、北京) 如果没有这列 此处改为具体的城市名称boolTableHead=True  #如果第一行是表头 此处为True，否则为Falsetag=0def main():    with open(inputFilePath, "r") as f:        lines = f.readlines()        for k, v in enumerate(lines):            if boolTableHead and k==0:                continue            line = lines[k]            itemArray = line.split(',')            global tag            tag += 1            print k            if type(cityIndex) is types.IntType:                cityname = itemArray[cityIndex]            else:                cityname = cityIndex            if type(itemArray[idIndex]) is types.IntType:                itemArray[idIndex]=str(itemArray[idIndex])            getLonLat(itemArray[idIndex], itemArray[addressIndex], cityname)# 根据地址得到经纬度k = 1def getLonLat(id,address, city):    global  k    # 每2w个暂停10s    if id == 20000 * k :        time.sleep(10)        k+=1    print address+',' + city    if address.find("\"")!=-1:        address=address.replace("\"","",2)    api = "http://api.map.baidu.com/geocoder/v2/?output=json&ak="    api += "&" + urlencode({'address': address, 'city':city})    data = urllib2.urlopen(api);    response = data.read()    result = json.loads(response)    with open(outFilePath, 'a') as w:        if result['status'] == 0:            print 'ok '            w.write(str(tag)+','+address+','+str(result['result']['location']['lng']) + "," + str(result['result']['location']['lat']) + "\n")        else:            print 'no data'            w.write(str(tag)+','+address+','+'0,0\n')main()